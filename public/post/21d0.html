<!DOCTYPE html>


<html lang="zh-CN">
  

    <head>
      <meta charset="utf-8" />
       
      <meta name="keywords" content="前端 记录" />
       
      <meta name="description" content="记录 成为更好的自己" />
      
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title>安装Docker和Jenkins |  京涛个人博客</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="https://myblogger-1305472061.cos.ap-shanghai.myqcloud.com/logo.png" />
       
<link rel="stylesheet" href="/dist/main.css">

      
<link rel="stylesheet" href="/css/fonts/remixicon.css">

      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    </head>
  </html>
</html>


<body>
  <div id="app">
    
      
      <canvas width="1777" height="841"
        style="position: fixed; left: 0px; top: 0px; z-index: 99999; pointer-events: none;"></canvas>
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-安装Docker和Jenkins"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  安装Docker和Jenkins
</h1>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/post/21d0.html" class="article-date">
  <time datetime="2022-08-23T09:24:14.000Z" itemprop="datePublished">2022-08-23</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E7%9F%A5%E8%AF%86%E7%A7%AF%E7%B4%AF/">服务端知识积累</a> / <a class="article-category-link" href="/categories/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E7%9F%A5%E8%AF%86%E7%A7%AF%E7%B4%AF/Docker-Jenkins/">Docker & Jenkins</a>
  </div>
  
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> 字数统计:</span>
            <span class="post-count">2.3k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> 阅读时长≈</span>
            <span class="post-count">9 分钟</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <p>自己动手实践部署jenkins记录</p>
<span id="more"></span>

<h3 id="什么是Docker"><a href="#什么是Docker" class="headerlink" title="什么是Docker"></a>什么是Docker</h3><p><code>Docker</code> 是一个开源的应用容器引擎。开发者可以将自己的应用打包在自己的镜像里面，然后迁移到其他平台的 <code>Docker</code> 中。镜像中可以存放你自己自定义的运行环境，文件，代码，设置等等内容，再也不用担心环境造成的运行问题。镜像共享运行机器的系统内核。</p>
<p>同样， <code>Docker</code> 也支持跨平台。你的镜像也可以加载在 <code>Windows</code> 和 <code>Linux</code>，实现快速运行和部署。</p>
<p><code>Docker</code> 的优势在于 快速，轻量，灵活。开发者可以制作一个自己自定义的镜像，也可以使用官方或者其他开发者的镜像来启动一个服务。通过将镜像创建为容器，容器之间相互隔离资源和进程不冲突。但硬件资源又是共享的。 创建的镜像也可以通过文件快速分享，也可以上传到镜像库进行存取和管理。同时 <code>Docker</code> 的镜像有 <code>分层策略</code> ，每次对镜像的更新操作，都会堆叠一个新层。当你拉取 / 推送新版本镜像时，只推送 / 拉取修改的部分。大大加快了镜像的传输效率</p>
<p>那么 <code>Docker</code> 在 <code>CI/CD</code> 中的作用是什么呢？</p>
<p><code>Docker</code> 贯穿 <code>CI/CD</code> 中整个流程。作为应用服务的载体有着非常重要的地位。</p>
<p>我们可以使用 <code>Docker</code> 将应用打包成一个镜像，交给 <code>Kubernetes</code> 去部署在目标服务集群。并且可以将镜像上传到自己的镜像仓库，做好版本分类处理。</p>
<h3 id="安装Docker"><a href="#安装Docker" class="headerlink" title="安装Docker"></a>安装Docker</h3><p>在了解了 <code>Docker</code> 的作用后，我们来开始安装 <code>Docker</code>。在开始安装之前，需要安装 <code>device-mapper-persistent-data</code> 和 <code>lvm2</code> 两个依赖。</p>
<p><code>device-mapper-persistent-data</code> 是 <code>Linux</code> 下的一个存储驱动， <code>Linux</code> 上的高级存储技术。 <code>Lvm</code> 的作用则是创建逻辑磁盘分区。这里我们使用 <code>CentOS</code> 的 <code>Yum</code> 包管理器安装两个依赖：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum install -y yum-utils device-mapper-persistent-data lvm2</span><br></pre></td></tr></table></figure>

<p>依赖安装完毕后，我们将阿里云的 <code>Docker</code> 镜像源添加进去。可以加速 <code>Docker</code> 的安装。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line">yum install docker-ce -y</span><br></pre></td></tr></table></figure>

<p>安装完毕，我们就可以使用 <code>systemctl</code> 启动来启动 <code>Docker</code> 了。<code>systemctl</code> 是 <code>Linux</code> 的进程管理服务命令，他可以帮助我们启动 <code>docker</code> </p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">systemctl start docker</span><br><span class="line">systemctl enable docker</span><br></pre></td></tr></table></figure>

<p>接着执行一下 <code>docker -v</code> ，这条命令可以用来查看 <code>Docker</code> 安装的版本信息。当然也可以帮助我们查看 <code>docker</code> 安装状态。如果正常展示版本信息，代表 <code>Docker</code> 已经安装成功。</p>
<h4 id="配置阿里云镜像源"><a href="#配置阿里云镜像源" class="headerlink" title="配置阿里云镜像源"></a>配置阿里云镜像源</h4><p>在 <code>Docker</code> 安装完毕后，之后我们去拉取 <code>docker</code> 镜像时，一般默认会去 <code>docker</code> 官方源拉取镜像。但是国内出海网速实在是太慢，所以选择我们更换为 <code>阿里云镜像仓库</code> 源进行镜像下载加速。</p>
<p>登录阿里云官网，打开 <a href="https://link.juejin.cn/?target=https://cr.console.aliyun.com">阿里云容器镜像服务</a>。点击左侧菜单最下面的 <code>镜像加速器</code> ，选择 <code>CentOS</code> （如下图）。按照官网的提示执行命令，即可更换 <code>docker</code> 镜像源地址。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo mkdir -p /etc/docker</span><br><span class="line">sudo tee /etc/docker/daemon.json &lt;&lt;-&#x27;EOF&#x27;</span><br><span class="line">&#123;</span><br><span class="line">  &quot;registry-mirrors&quot;: [&quot;https://vxedgf56.mirror.aliyuncs.com&quot;]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure>



<h3 id="安装Jenkins"><a href="#安装Jenkins" class="headerlink" title="安装Jenkins"></a>安装Jenkins</h3><p>在安装完 <code>Docker</code> 后，我们只是拥有了一个可以承载服务的载体。想实现自动化构建，还需要安装另一个构建工具 <code>Jenkins</code>。那什么是 <code>Jenkins</code> 呢？</p>
<p><code>Jenkins</code> 是一个基于 <code>Java</code> 语言开发的持续构建工具平台，主要用于持续、自动的构建/测试你的软件和项目。它可以执行你预先设定好的设置和构建脚本，也可以和 Git 代码库做集成，实现自动触发和定时触发构建。</p>
<h4 id="1-安装OpenJDK"><a href="#1-安装OpenJDK" class="headerlink" title="1. 安装OpenJDK"></a>1. 安装OpenJDK</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yum install -y java</span><br></pre></td></tr></table></figure>

<h4 id="2-使用Yum安装Jenkins"><a href="#2-使用Yum安装Jenkins" class="headerlink" title="2. 使用Yum安装Jenkins"></a>2. 使用Yum安装Jenkins</h4><p>由于 <code>Yum</code> 源不自带 <code>Jenkins</code> 的安装源，于是我们需要自己导入一份 <code>Jenkins</code> 安装源进行安装。导入后，使用 <code>Yum</code> 命令安装即可。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo</span><br><span class="line">sudo rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io.key</span><br><span class="line">yum install jenkins</span><br></pre></td></tr></table></figure>

<p><code>TIP1:</code></p>
<p>执行第一条命令时有概率出现下面的错误，如果出现了，就执行解决中的命令，然后再导入秘钥（第二条）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ERROR: cannot verify pkg.jenkins.io&#x27;s certificate, issued by ‘/C=US/O=Let&#x27;s Encrypt/CN=R3’:</span><br><span class="line">  Issued certificate has expired.</span><br><span class="line">To connect to pkg.jenkins.io insecurely, use `--no-check-certificate&#x27;.</span><br></pre></td></tr></table></figure>

<p>解决：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wget --no-check-certificate -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo</span><br></pre></td></tr></table></figure>

<p>然后重新执行后面的命令。</p>
<p><code>TIP2:</code></p>
<p>执行下载jenkens命令时很可能出现下面的错误：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Loaded plugins: fastestmirror, langpacks</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * base: mirrors.bfsu.edu.cn</span><br><span class="line"> * extras: mirrors.ustc.edu.cn</span><br><span class="line"> * updates: mirrors.bfsu.edu.cn</span><br><span class="line">No package jenkins available.</span><br><span class="line">/* 依赖检测失败 */</span><br></pre></td></tr></table></figure>

<p>解决：</p>
<p><strong>安装epel-release</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum install -y epel-release</span><br></pre></td></tr></table></figure>

<p><strong>安装daemonize</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum -y install daemonize</span><br></pre></td></tr></table></figure>

<p>然后重新下载jenkins</p>
<h4 id="3-启动Jenkins"><a href="#3-启动Jenkins" class="headerlink" title="3.启动Jenkins"></a>3.启动Jenkins</h4><p><code>Jenkins</code> 安装后，会将启动命令注册到系统 <code>Service</code> 命令中。所以我们直接使用系统 <code>service</code> 命令启动 <code>Jenkins</code> 即可。在这里，有三个命令可以使用，分别对应 启动 / 重启 / 停止 三个命令。</p>
<p>在这里，我们直接调用 <code>service jenkins start</code> 启动 Jenkins 即可</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">service jenkins start</span><br><span class="line"># service jenkins restart restart 重启 Jenkins</span><br><span class="line"># service jenkins restart stop 停止 Jenkins</span><br></pre></td></tr></table></figure>

<h4 id="4-给Jenkins放行端口"><a href="#4-给Jenkins放行端口" class="headerlink" title="4.给Jenkins放行端口"></a>4.给Jenkins放行端口</h4><p>在启动 <code>Jenkins</code> 后，此时 <code>Jenkins</code> 会开启它的默认端口 <code>8080</code> 。但由于防火墙限制，我们需要手动让防火墙放行 <code>8080</code> 端口才能对外访问到界面。</p>
<p>这里我们在 <code>CentOS</code> 下的 <code>firewall-cmd</code> 防火墙添加端口放行规则，添加完后重启防火墙。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=8080/tcp --permanent</span><br><span class="line">firewall-cmd --zone=public --add-port=50000/tcp --permanent</span><br><span class="line"></span><br><span class="line">systemctl reload firewalld</span><br></pre></td></tr></table></figure>

<p>服务启动后，访问 <code>IP:8080</code> 。</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h5gtzldgypj20yy0riq44.jpg" alt="WeChat8213c3f9330e1b618a64135d7d506987"></p>
<h4 id="5-初始化Jenkins配置"><a href="#5-初始化Jenkins配置" class="headerlink" title="5.初始化Jenkins配置"></a>5.初始化Jenkins配置</h4><p><strong>5.1 解锁Jenkins</strong></p>
<p>在 <code>Jenkins</code> 启动完成后，会自动跳转至<code>Jenkins</code> 的解锁界面，你需要输入存放在服务器的初始解锁密码才能进行下一步操作。</p>
<p><code>Jenkins</code> 启动后，会生成一个<strong>初始密码</strong>。该密码在服务器的文件内存放，我们可以进入服务器查看密码内容，将密码填写在 <code>Jenkins</code> 的管理员密码输入框内。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat /var/lib/jenkins/secrets/initialAdminPassword</span><br></pre></td></tr></table></figure>

<p><strong>5.2 下载插件</strong></p>
<p>因为 <code>Jenkins</code> 插件服务器在国外，所以速度不太理想。我们需要更换为清华大学的 <code>Jenkins</code> 插件源后，再安装插件，<strong>所以先不要点安装插件。</strong></p>
<p>更换方法很简单。进入服务器，将 <code>/var/lib/jenkins/updates/default.json</code> 内的插件源地址替换成清华大学的源地址，将 google 替换为 baidu 即可。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sed -i &#x27;s/http:\/\/updates.jenkins-ci.org\/download/https:\/\/mirrors.tuna.tsinghua.edu.cn\/jenkins/g&#x27; /var/lib/jenkins/updates/default.json &amp;&amp; sed -i &#x27;s/http:\/\/www.google.com/https:\/\/www.baidu.com/g&#x27; /var/lib/jenkins/updates/default.json</span><br></pre></td></tr></table></figure>

<p>接着点击 <code>安装推荐的插件</code> 即可。稍等一会插件安装完毕。</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h5gtusazi3j20uj0u0dhp.jpg" alt="image-20211207193019958"></p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h5gu0l7hgbj21c10u0di6.jpg" alt="WechatIMG1256"></p>
<h4 id="6-测试安装"><a href="#6-测试安装" class="headerlink" title="6.测试安装"></a>6.测试安装</h4><p>到这里，我们的 Jenkins 算是启动成功了。但是，我们还需要对 <code>Jenkins</code> 做一点点简单的配置，才可以让它可以构建 <code>docker</code> 镜像。</p>
<p>我们点击 <code>Jenkins</code> 首页 -&gt; 左侧导航 -&gt; 新建任务 -&gt; <strong>Freestyle project</strong></p>
<p><strong><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h5gu144il8j21no0u0786.jpg" alt="WeChatf1c493eccf9d6aff70b3f11b17e70d5a"></strong></p>
<p>新建完毕后，找到 <code>构建</code> 一项，选择 <code>增加构建步骤</code>，选择 <code>执行shell</code> ，输入以下命令：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker -v</span><br><span class="line">docker pull node:latest</span><br></pre></td></tr></table></figure>

<p>该命令会去拉取一个 <code>nodejs</code> 稳定版的镜像，我们可以来测试 <code>Docker</code> 的可用性。</p>
<p>保存后，我们点击左侧菜单的<strong>立即构建</strong>， <code>Jenkins</code> 就会开始构建。选择左侧历史记录第一项（最新的一项），点击控制台输出，查看构建日志。</p>
<p>执行后，我们发现提示无访问权限。这又是什么情况呢？这里就不得不提到 <code>Linux</code> 下的 <code>Unix Socket</code>权限问题了。</p>
<h4 id="7-Unix-Socket权限问题"><a href="#7-Unix-Socket权限问题" class="headerlink" title="7.Unix Socket权限问题"></a>7.Unix Socket权限问题</h4><p><code>docker</code> 的架构是 <code>C/S</code> 架构。在我们使用 <code>docker</code> 命令时，其实是命令使用 <code>socket</code> 与 <code>docker</code> 的守护进程进行通信，才能正常执行 <code>docker</code> 命令。</p>
<p>而在 <code>Linux</code> 中， <code>Unix socket</code> 属于 <code>root</code> 用户，因此需要 <code>root</code> 权限才能访问。官方是这么解释的：</p>
<blockquote>
<p>Manage Docker as a non-root user The docker daemon binds to a Unix socket instead of a TCP port. By default that Unix socket is owned by the user root and other users can only access it using sudo. The docker daemon always runs as the root user. If you don’t want to use sudo when you use the docker command, create a Unix group called docker and add users to it. When the docker daemon starts, it makes the ownership of the Unix socket read/writable by the docker group.</p>
</blockquote>
<p>但是在 <code>docker</code> 中， <code>docker</code> 提供了一个 <code>用户组</code> 的概念。我们可以将执行 <code>Shell</code> 的用户添加到名称为 <code>docker</code> 的用户组，则可以正常执行 <code>docker</code> 命令。</p>
<p>而在 <code>Jenkins</code> 中执行的终端用户做 <code>jenkins</code> ，所以我们只需要将 <code>jenkins</code> 加入到 <code>docker</code> 用户组即可：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo groupadd docker          #新增docker用户组</span><br><span class="line">sudo gpasswd -a jenkins docker  #将当前用户添加至docker用户组</span><br><span class="line">newgrp docker                 #更新docker用户组</span><br></pre></td></tr></table></figure>

<p>加入后，重启 <code>Jenkins</code> ：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo service jenkins restart</span><br></pre></td></tr></table></figure>

<p>刷新页面等待jenkins重新启动并登入账号密码：</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h5gu1nsn7aj21480rmab5.jpg" alt="WeChatf7664d9dfaa1e741a63dacfc54a08b87"></p>
<p>之后重新登录成功后构建:</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h5gu206lt4j21by0u00wm.jpg" alt="WeChatf7664d9dfaa1e741a63dacfc54a08b87"></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%9F%A5%E8%AF%86%E7%A7%AF%E7%B4%AF/" rel="tag">知识积累</a></li></ul>

    </footer>
  </div>

   
  <nav class="article-nav">
    
      <a href="/post/0.html" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">
          
            国密4加密算法JS版本
          
        </div>
      </a>
    
    
      <a href="/post/83d9.html" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">持久化vuex</div>
      </a>
    
  </nav>

  
   
<div class="gitalk" id="gitalk-container"></div>

<link rel="stylesheet" href="https://cdn.staticfile.org/gitalk/1.7.2/gitalk.min.css">


<script src="https://cdn.staticfile.org/gitalk/1.7.2/gitalk.min.js"></script>


<script src="https://cdn.staticfile.org/blueimp-md5/2.19.0/js/md5.min.js"></script>

<script type="text/javascript">
  var gitalk = new Gitalk({
    clientID: '0f7dec984fa359926d3a',
    clientSecret: 'ba07a8f4f94693c69dd00ba7a6551751f1197548',
    repo: 'myblog-comments',
    owner: 'JingTao-Li',
    admin: ['JingTao-Li'],
    // id: location.pathname,      // Ensure uniqueness and length less than 50
    id: md5(location.pathname),
    distractionFreeMode: false,  // Facebook-like distraction free mode
    pagerDirection: 'last'
  })

  gitalk.render('gitalk-container')
</script>

     
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2020-2022
        <i class="ri-heart-fill heart_icon"></i> 京涛
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>访问人数:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>浏览次数:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/logo-header.png" alt="京涛个人博客"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/photos">相册</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags/%E6%97%85%E8%A1%8C/">旅行</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="搜索">
        <i class="ri-search-line"></i>
      </a>
      
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->
 
<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: ".tocbot",
    contentSelector: ".article-entry",
    headingSelector: "h1, h2, h3, h4, h5, h6",
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: "main",
    positionFixedSelector: ".tocbot",
    positionFixedClass: "is-position-fixed",
    fixedSidebarOffset: "auto",
  });
</script>

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->
 
<script src="/js/clickBoom2.js"></script>
 
<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->
 
<script src="/js/dz.js"></script>
 
<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    <div id="music">
    
    
    
    <iframe frameborder="no" border="1" marginwidth="0" marginheight="0" width="200" height="52"
        src="//music.163.com/outchain/player?type=2&id=488902553&auto=1&height=32"></iframe>
</div>

<style>
    #music {
        position: fixed;
        right: 15px;
        bottom: -10px;
        z-index: 998;
    }
</style>
    
    

  </div>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/haruto.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":1},"dialog":{"hitokoto":true,"enable":true},"log":false});</script></body>

</html>